<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Document</title>
  <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }

    #back {
      position: absolute;
      bottom: 20px;
    }

    #back i {
      background-image: url(app/public/img/back.svg);
      background-repeat: no-repeat;
      display: inline-block;
      width: 100px;
      height: 25px;
      padding-left: 25px;
      padding-top: 2px;
      margin: 10px;
      cursor: pointer;
      background-size: 20px;
    }
  </style>
  <link rel="stylesheet" href="https://js.arcgis.com/4.16/esri/themes/light/main.css" />
  <script src="https://js.arcgis.com/4.16/"></script>
  <script>

    var list_points = [];
    var string_points = "";

    function copyTextToClipboard(text) {
      if (!navigator.clipboard) {
        fallbackCopyTextToClipboard(text);
        return;
      }
      navigator.clipboard.writeText(text).then(
        function () {
          console.log("Async: Copying to clipboard was successful!");
        },
        function (err) {
          console.error("Async: Could not copy text: ", err);
        }
      );
    }

    require([
      "esri/Map",
      "esri/views/SceneView",
      "esri/layers/GeoJSONLayer",
      "esri/layers/SceneLayer",
      "esri/layers/GraphicsLayer",
      "esri/Graphic",
      "esri/request",
      "esri/geometry/Mesh",
      "esri/geometry/Point",
    ], function (
      Map,
      SceneView,
      GeoJSONLayer,
      SceneLayer,
      GraphicsLayer,
      Graphic,
      esriRequest,
      Mesh,
      Point
    ) {
      var createGraphic = function (data) {
        return new Graphic({
          geometry: data,
          symbol: data.symbol,
          attributes: data,
          popupTemplate: data.popupTemplate,
        });
      };

      // background1
      const background1 = new GeoJSONLayer({
        url: "./GeoJSON/background1.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 8,
                material: {
                  color: "smoke",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const background2 = new GeoJSONLayer({
        url: "./GeoJSON/background2.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 1,
                material: {
                  color: "#cfcfcf",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "#000000",
                },
              },
            ],
          },
        },
      });

      const background3 = new GeoJSONLayer({
        url: "./GeoJSON/background3.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 1,
                material: {
                  color: "#dacdc0",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "#000000",
                },
              },
            ],
          },
        },
      });

      //border
      const border1 = new GeoJSONLayer({
        url: "./GeoJSON/border/border_1.geojson",
        //bside wall 1
        // const wall_1 = new GeoJSONLayer({
        //   url: "./GeoJSON/block4/wall/wall_4.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                //           size: 1.5,
                //           material: {
                //             color: "smoke",
                //           },
                //           edges: {
                //             type: "solid", // autocasts as new SolidEdges3D()
                //             color: "transparent",
                //           },
                //         },
                //       ],
                //     },
                //   },
                // });

                // const border2 = new GeoJSONLayer({
                //   url: "./GeoJSON/border/border_2.geojson",
                //   renderer: {
                //     type: "simple",
                //     symbol: {
                //       type: "polygon-3d",
                //       symbolLayers: [
                //         {
                //           type: "extrude",
                //           size: 1,
                //           material: {
                //             color: "#fbedd7",
                //           },
                //           edges: {
                //             type: "solid", // autocasts as new SolidEdges3D()
                //             color: "transparent",
                //           },
                //         },
                //       ],
                //     },
                //   },
                // });

                // const border3 = new GeoJSONLayer({
                //   url: "./GeoJSON/border/border_3.geojson",
                //   renderer: {
                //     type: "simple",
                //     symbol: {
                //       type: "polygon-3d",
                //       symbolLayers: [
                //         {
                //           type: "extrude",
                //           size: 0.5,
                //           material: {
                //             color: "#fbedd7",
                //           },
                //           edges: {
                //             type: "solid", // autocasts as new SolidEdges3D()
                size: 5,
                material: {
                  color: '#fbedd7'
                  //[251, 237, 215, 0.2],
                },
                edges: {
                  type: "solid",
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      // roof
      const roof1 = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof1.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 1.5,
                material: {
                  color: "#dacdc0",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      //roof2
      const roof2 = new GeoJSONLayer({
        url: "./GeoJSON/roof/roof2.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 1,
                material: {
                  color: "#e9cb8a",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      //roof3
      const roof3 = new GeoJSONLayer({
        url: "./GeoJSON/roof/roof3.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 0.4,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });


      const pillars = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/pillars/pillars.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 19.3,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const roof_left = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof_left.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 2,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const roof_right = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof_right.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 2,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const roof_left_roof = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof_left_roof.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 0.3,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const roof_right_roof = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof_right_roof.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 0.3,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const roof_innner_border = new GeoJSONLayer({
        url: "./GeoJSON/block4_above/roofs/roof_inner_border.geojson",
        renderer: {
          type: "simple",
          symbol: {
            type: "polygon-3d",
            symbolLayers: [
              {
                type: "extrude",
                size: 0.2,
                material: {
                  color: "#fbedd7",
                },
                edges: {
                  type: "solid", // autocasts as new SolidEdges3D()
                  color: "transparent",
                },
              },
            ],
          },
        },
      });

      const map = new Map({
        basemap: "topo-vector",
        ground: "world-elevation",
        layers: [
          border1,
          border2,
          border3,
          roof1,
          roof2,
          roof3,
          background1,
          background2,
          background3,
          pillars,
          roof_left,
          roof_right,
          roof_left_roof,
          roof_right_roof,
          roof_innner_border,
          // border1,
          // border2,
          // border3,
          // background1
          wall_1
        ], //end layers
      });

      const view = new SceneView({
        container: "viewDiv",
        map: map,
        camera: {
          position: [106.69495037907745, 10.77410539190575, 230],
          heading: 0,
          tilt: 55,
        },
      });

      view.popup.defaultPopupTemplateEnabled = true;

      view.popup.autoOpenEnabled = false; // Disable the default popup behavior
      view.on("click", function (event) {
        // Listen for the click event
        view.hitTest(event).then(function (hitTestResults) {
          // Search for features where the user clicked
          if (hitTestResults.results) {
            list_points.push([
              event.mapPoint.longitude,
              event.mapPoint.latitude,
            ]);
            string_points +=
              "[" +
              event.mapPoint.longitude +
              ", " +
              event.mapPoint.latitude +
              "],";
            console.log(event.mapPoint.longitude + " " + event.mapPoint.latitude)
            copyTextToClipboard(string_points);
            // console.log(list_points);
          }
        });
      });

      view.popup.defaultPopupTemplateEnabled = true;
    });
  </script>
</head>

<body>
  <div id="viewDiv"></div>
</body>

</html>